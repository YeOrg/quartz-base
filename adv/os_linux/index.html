<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Linuxä¸‹å¥½ç”¨çš„Command 1 2 3 4  # ç±»ä¼¼Windowsçš„Explorer ranger # ç±»ä¼¼Windowsä¸‹çš„everythinh fzf   Frp å¿«é€Ÿåå‘ä»£ç† å¦‚æœä½ æœ‰ä¸€å°ç‹¬ç«‹ä¸»æœºï¼ŒåŒæ—¶ä½ æƒ³æš´éœ²è‡ªå·±æœ¬åœ°çš„æœåŠ¡åˆ°å¤–éƒ¨ï¼Œå¯ä»¥åœ¨ç‹¬ç«‹ä¸»æœºä¸Šéƒ¨ç½²frpçš„æœåŠ¡ç«¯ï¼Œæœ¬åœ°éƒ¨ç½²frpçš„å®¢æˆ·ç«¯ï¼Œè¿™æ ·å½“å¤–éƒ¨è®¿é—®ä½ ç‹¬ç«‹ä¸»æœºçš„frpå°±ä¼šè½¬å‘åˆ°æœ¬åœ°ã€‚
Install  GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet."><meta property="og:title" content="OS - Linux"><meta property="og:description" content="Linuxä¸‹å¥½ç”¨çš„Command 1 2 3 4  # ç±»ä¼¼Windowsçš„Explorer ranger # ç±»ä¼¼Windowsä¸‹çš„everythinh fzf   Frp å¿«é€Ÿåå‘ä»£ç† å¦‚æœä½ æœ‰ä¸€å°ç‹¬ç«‹ä¸»æœºï¼ŒåŒæ—¶ä½ æƒ³æš´éœ²è‡ªå·±æœ¬åœ°çš„æœåŠ¡åˆ°å¤–éƒ¨ï¼Œå¯ä»¥åœ¨ç‹¬ç«‹ä¸»æœºä¸Šéƒ¨ç½²frpçš„æœåŠ¡ç«¯ï¼Œæœ¬åœ°éƒ¨ç½²frpçš„å®¢æˆ·ç«¯ï¼Œè¿™æ ·å½“å¤–éƒ¨è®¿é—®ä½ ç‹¬ç«‹ä¸»æœºçš„frpå°±ä¼šè½¬å‘åˆ°æœ¬åœ°ã€‚
Install  GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet."><meta property="og:type" content="website"><meta property="og:image" content="https://knowledge.xyzzyxwz.top/icon.png"><meta property="og:url" content="https://knowledge.xyzzyxwz.top/adv/os_linux/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="OS - Linux"><meta name=twitter:description content="Linuxä¸‹å¥½ç”¨çš„Command 1 2 3 4  # ç±»ä¼¼Windowsçš„Explorer ranger # ç±»ä¼¼Windowsä¸‹çš„everythinh fzf   Frp å¿«é€Ÿåå‘ä»£ç† å¦‚æœä½ æœ‰ä¸€å°ç‹¬ç«‹ä¸»æœºï¼ŒåŒæ—¶ä½ æƒ³æš´éœ²è‡ªå·±æœ¬åœ°çš„æœåŠ¡åˆ°å¤–éƒ¨ï¼Œå¯ä»¥åœ¨ç‹¬ç«‹ä¸»æœºä¸Šéƒ¨ç½²frpçš„æœåŠ¡ç«¯ï¼Œæœ¬åœ°éƒ¨ç½²frpçš„å®¢æˆ·ç«¯ï¼Œè¿™æ ·å½“å¤–éƒ¨è®¿é—®ä½ ç‹¬ç«‹ä¸»æœºçš„frpå°±ä¼šè½¬å‘åˆ°æœ¬åœ°ã€‚
Install  GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet."><meta name=twitter:image content="https://knowledge.xyzzyxwz.top/icon.png"><meta name=twitter:site content="aaaron_li"><title>OS - Linux</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://knowledge.xyzzyxwz.top//SpongeBob.png><link href=https://knowledge.xyzzyxwz.top/styles.19109a40042e9f0e72e952fda4442a34.min.css rel=stylesheet><link href=https://knowledge.xyzzyxwz.top/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://knowledge.xyzzyxwz.top/js/darkmode.f0d8c193b0592224da25f0e9a9077f69.min.js></script>
<script src=https://knowledge.xyzzyxwz.top/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css integrity=sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js integrity=sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://knowledge.xyzzyxwz.top/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://knowledge.xyzzyxwz.top/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://knowledge.xyzzyxwz.top/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://knowledge.xyzzyxwz.top/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://knowledge.xyzzyxwz.top/",fetchData=Promise.all([fetch("https://knowledge.xyzzyxwz.top/indices/linkIndex.9b878c556efdd7259d879d4cd3f3c908.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://knowledge.xyzzyxwz.top/indices/contentIndex.1dc3efe81fb1625edd28eb54c09d0c20.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://knowledge.xyzzyxwz.top",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://knowledge.xyzzyxwz.top",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:3,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/knowledge.xyzzyxwz.top\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=knowledge.xyzzyxwz.top src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://knowledge.xyzzyxwz.top/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://knowledge.xyzzyxwz.top/>Knowledge</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>OS - Linux</h1><p class=meta>Last updated
Sep 23, 2024
<a href=https://github.com/YeOrg/quartz-base/tree/hugo/content/adv/os_linux.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#install>Install</a></li><li><a href=#config>Config</a></li></ol><ol><li><a href=#install-1>Install</a></li><li><a href=#renew>Renew</a></li><li><a href=#config-1>Config</a></li></ol><ol><li><a href=#æœåŠ¡ç«¯>æœåŠ¡ç«¯</a></li><li><a href=#å®¢æˆ·ç«¯>å®¢æˆ·ç«¯</a></li></ol><ol><li><a href=#ä¸€-æ£€æŸ¥æ˜¯å¦æ—¥å¿—æ–‡ä»¶å¤¹è¢«åˆ é™¤>ä¸€ æ£€æŸ¥æ˜¯å¦æ—¥å¿—æ–‡ä»¶å¤¹è¢«åˆ é™¤</a></li></ol></nav></details></aside><a href=#linuxä¸‹å¥½ç”¨çš„command><h1 id=linuxä¸‹å¥½ç”¨çš„command><span class=hanchor arialabel=Anchor># </span>Linuxä¸‹å¥½ç”¨çš„Command</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ç±»ä¼¼Windowsçš„Explorer</span>
</span></span><span class=line><span class=cl>ranger
</span></span><span class=line><span class=cl><span class=c1># ç±»ä¼¼Windowsä¸‹çš„everythinh</span>
</span></span><span class=line><span class=cl>fzf
</span></span></code></pre></td></tr></table></div></div><a href=#frp-å¿«é€Ÿåå‘ä»£ç†><h1 id=frp-å¿«é€Ÿåå‘ä»£ç†><span class=hanchor arialabel=Anchor># </span>Frp å¿«é€Ÿåå‘ä»£ç†</h1></a><p>å¦‚æœä½ æœ‰ä¸€å°ç‹¬ç«‹ä¸»æœºï¼ŒåŒæ—¶ä½ æƒ³æš´éœ²è‡ªå·±æœ¬åœ°çš„æœåŠ¡åˆ°å¤–éƒ¨ï¼Œå¯ä»¥åœ¨ç‹¬ç«‹ä¸»æœºä¸Šéƒ¨ç½²frpçš„æœåŠ¡ç«¯ï¼Œæœ¬åœ°éƒ¨ç½²frpçš„å®¢æˆ·ç«¯ï¼Œè¿™æ ·å½“å¤–éƒ¨è®¿é—®ä½ ç‹¬ç«‹ä¸»æœºçš„frpå°±ä¼šè½¬å‘åˆ°æœ¬åœ°ã€‚</p><a href=#install><h2 id=install><span class=hanchor arialabel=Anchor># </span>Install</h2></a><p><a href=https://github.com/fatedier/frp rel=noopener>GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet.</a></p><p>åœ¨Releaseé¡µé¢ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ã€‚</p><a href=#config><h2 id=config><span class=hanchor arialabel=Anchor># </span>Config</h2></a><p>æœåŠ¡ç«¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>common<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>bind_port</span> <span class=o>=</span> <span class=m>12031</span>  // å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥çš„ç«¯å£
</span></span><span class=line><span class=cl><span class=nv>token</span> <span class=o>=</span> &lt;your-token: number&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>dashboard_port</span> <span class=o>=</span> <span class=m>12032</span>
</span></span><span class=line><span class=cl><span class=nv>dashboard_user</span> <span class=o>=</span> &lt;username&gt;
</span></span><span class=line><span class=cl><span class=nv>dashboard_pwd</span> <span class=o>=</span> &lt;password&gt;
</span></span><span class=line><span class=cl><span class=nv>enable_prometheus</span> <span class=o>=</span> <span class=nb>true</span>  // æ™®ç½—ç±³ä¿®æ–¯è¿ç»´æœåŠ¡,å¯ä»¥å…³é—­
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>log_file</span> <span class=o>=</span> /var/log/frps.log
</span></span><span class=line><span class=cl><span class=nv>log_level</span> <span class=o>=</span> info
</span></span><span class=line><span class=cl><span class=nv>log_max_days</span> <span class=o>=</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>vhost_http_port</span> <span class=o>=</span> <span class=m>13040</span>  // æ˜¯å†…éƒ¨æ˜ å°„åˆ°å¤–éƒ¨çš„å¯¹å¤–ç«¯å£
</span></span><span class=line><span class=cl><span class=nv>vhost_https_port</span> <span class=o>=</span> <span class=m>13043</span> // æš‚æ—¶æœªç”¨ï¼Œè€Œæ˜¯é€šè¿‡nginxé…ç½®sslè½¬å‘èµ°http
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span>Bidirectional verification  // åŒå‘éªŒè¯
</span></span><span class=line><span class=cl><span class=nv>tls_only</span> <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>tls_enable</span> <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>tls_cert_file</span> <span class=o>=</span> /root/frp/ca2/server.crt
</span></span><span class=line><span class=cl><span class=nv>tls_key_file</span> <span class=o>=</span> /root/frp/ca2/server.key
</span></span><span class=line><span class=cl><span class=nv>tls_trusted_ca_file</span> <span class=o>=</span> /root/frp/ca2/ca.crt
</span></span></code></pre></td></tr></table></div></div><p>å®¢æˆ·ç«¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>common<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>server_addr</span> <span class=o>=</span> &lt;your-address-ip&gt;
</span></span><span class=line><span class=cl><span class=nv>server_port</span> <span class=o>=</span> <span class=m>12031</span>
</span></span><span class=line><span class=cl><span class=nv>token</span> <span class=o>=</span> &lt;your-token: number&gt;  // ä¸æœåŠ¡ç«¯ä¸€è‡´
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span>Bidirectional verification  // åŒå‘éªŒè¯
</span></span><span class=line><span class=cl><span class=nv>tls_enable</span> <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>tls_cert_file</span> <span class=o>=</span> C:/src/ub/frp/ca1/client.crt
</span></span><span class=line><span class=cl><span class=nv>tls_key_file</span> <span class=o>=</span> C:/src/ub/frp/ca1/client.key
</span></span><span class=line><span class=cl><span class=nv>tls_trusted_ca_file</span> <span class=o>=</span> C:/src/ub/frp/ca1/ca.crt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// ä¸€ä¸ªé…ç½®ç¤ºä¾‹ï¼Œè½¬å‘æœ¬åœ°çš„15060ç«¯å£
</span></span><span class=line><span class=cl>//   è¿™æ ·å½“å¤–éƒ¨è®¿é—®åŸŸå<span class=sb>`</span>sub.xyzzyxwz.top<span class=sb>`</span>æ—¶å°±ä¼šè½¬å‘åˆ°æœ¬åœ°è¿™ä¸ªç«¯å£ã€‚
</span></span><span class=line><span class=cl><span class=o>[</span>httpname1-pre<span class=o>]</span>  
</span></span><span class=line><span class=cl><span class=nb>type</span> <span class=o>=</span> http
</span></span><span class=line><span class=cl><span class=nv>local_port</span> <span class=o>=</span> <span class=m>15060</span>
</span></span><span class=line><span class=cl><span class=nv>local_ip</span> <span class=o>=</span> 127.0.0.1
</span></span><span class=line><span class=cl><span class=nv>custom_domains</span> <span class=o>=</span> sub.xyzzyxwz.top
</span></span></code></pre></td></tr></table></div></div><p>åŒå‘éªŒè¯å¯†é’¥ç”Ÿæˆ</p><p>æ–‡ä»¶ <code>my-openssl.cnf</code>ï¼Œè¿™æ–‡ä»¶æˆ‘æ˜¯ä¸æ‡‚çš„ï¼Œä¹Ÿä¸çŸ¥é“ä»å“ªæ‹¿æ¥çš„äº†(â—Ë‡âˆ€Ë‡â—)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span> ca <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>default_ca</span> <span class=o>=</span> CA_default
</span></span><span class=line><span class=cl><span class=o>[</span> CA_default <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>x509_extensions</span> <span class=o>=</span> usr_cert
</span></span><span class=line><span class=cl><span class=o>[</span> req <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>default_bits</span>        <span class=o>=</span> <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=nv>default_md</span>          <span class=o>=</span> sha256
</span></span><span class=line><span class=cl><span class=nv>default_keyfile</span>     <span class=o>=</span> privkey.pem
</span></span><span class=line><span class=cl><span class=nv>distinguished_name</span>  <span class=o>=</span> req_distinguished_name
</span></span><span class=line><span class=cl><span class=nv>attributes</span>          <span class=o>=</span> req_attributes
</span></span><span class=line><span class=cl><span class=nv>x509_extensions</span>     <span class=o>=</span> v3_ca
</span></span><span class=line><span class=cl><span class=nv>string_mask</span>         <span class=o>=</span> utf8only
</span></span><span class=line><span class=cl><span class=o>[</span> req_distinguished_name <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span> req_attributes <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span> usr_cert <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>basicConstraints</span>       <span class=o>=</span> CA:FALSE
</span></span><span class=line><span class=cl><span class=nv>nsComment</span>              <span class=o>=</span> <span class=s2>&#34;OpenSSL Generated Certificate&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>subjectKeyIdentifier</span>   <span class=o>=</span> <span class=nb>hash</span>
</span></span><span class=line><span class=cl><span class=nv>authorityKeyIdentifier</span> <span class=o>=</span> keyid,issuer
</span></span><span class=line><span class=cl><span class=o>[</span> v3_ca <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>subjectKeyIdentifier</span>   <span class=o>=</span> <span class=nb>hash</span>
</span></span><span class=line><span class=cl><span class=nv>authorityKeyIdentifier</span> <span class=o>=</span> keyid:always,issuer
</span></span><span class=line><span class=cl><span class=nv>basicConstraints</span>       <span class=o>=</span> CA:true
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥åˆ°ä¸<code>my-openssl.cnf</code>æ–‡ä»¶çš„åŒä¸€ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹æ–¹å‘½ä»¤ï¼Œä¸€æ¡ä¸€æ¡çš„æ‰§è¡Œï¼Œæ³¨æ„åŒæ—¶æŠŠåŸŸåå’ŒIPæ”¹æˆè‡ªå·±çš„ã€‚</p><blockquote class=warning-callout><p>æ³¨æ„å¦‚æœåœ¨Windowsä¸‹éœ€è¦ç”¨cygwinçš„shellå»æ‰§è¡Œã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># TODO Frp TLS https://www.bookstack.cn/read/frp-0.36-zh/cf470b39f615dd74.md</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1.Generating a ca Certificate</span>
</span></span><span class=line><span class=cl><span class=c1>## Generate the ca key file</span>
</span></span><span class=line><span class=cl>openssl genrsa -out ca.key <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=c1>## Generating a ca Certificate</span>
</span></span><span class=line><span class=cl>openssl req -x509 -new -nodes -key ca.key -subj <span class=s2>&#34;/CN=xyzzyxwz.top&#34;</span> -days <span class=m>5000</span> -out ca.crt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2.Generate a server certificate</span>
</span></span><span class=line><span class=cl><span class=c1>## Generate the server key file</span>
</span></span><span class=line><span class=cl>openssl genrsa -out server.key <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=c1>## Generate the server CSR file</span>
</span></span><span class=line><span class=cl>openssl req -new -sha256 -key server.key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=XX/ST=DEFAULT/L=DEFAULT/O=DEFAULT/CN=xyzzyxwz.top&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -reqexts SAN <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -config &lt;<span class=o>(</span>cat my-openssl.cnf &lt;<span class=o>(</span><span class=nb>printf</span> <span class=s2>&#34;\n[SAN]\nsubjectAltName=DNS:localhost,IP:127.0.0.1,IP:80.251.217.246,DNS:xyzzyxwz.top&#34;</span><span class=o>))</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -out server.csr
</span></span><span class=line><span class=cl><span class=c1>## Generate a server certificate</span>
</span></span><span class=line><span class=cl>openssl x509 -req -days <span class=m>365</span> -sha256 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-extfile &lt;<span class=o>(</span><span class=nb>printf</span> <span class=s2>&#34;subjectAltName=DNS:localhost,IP:127.0.0.1,IP:80.251.217.246,DNS:xyzzyxwz.top&#34;</span><span class=o>)</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-out server.crt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3.Generate a client certificate</span>
</span></span><span class=line><span class=cl><span class=c1>## Generate the client key file</span>
</span></span><span class=line><span class=cl>openssl genrsa -out client.key <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=c1>## Generate the client CSR file</span>
</span></span><span class=line><span class=cl>openssl req -new -sha256 -key client.key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=XX/ST=DEFAULT/L=DEFAULT/O=DEFAULT/CN=client.com&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -reqexts SAN <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -config &lt;<span class=o>(</span>cat my-openssl.cnf &lt;<span class=o>(</span><span class=nb>printf</span> <span class=s2>&#34;\n[SAN]\nsubjectAltName=DNS:localhost,DNS:example.client.com&#34;</span><span class=o>))</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -out client.csr
</span></span><span class=line><span class=cl><span class=c1>## Generate a client certificate</span>
</span></span><span class=line><span class=cl>openssl x509 -req -days <span class=m>365</span> -sha256 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-extfile &lt;<span class=o>(</span><span class=nb>printf</span> <span class=s2>&#34;subjectAltName=DNS:localhost,DNS:example.client.com&#34;</span><span class=o>)</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-out client.crt
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæˆåŠŸäº†ï¼Œåº”è¯¥æ˜¯ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ã€‚ç„¶åé…ç½®æ–‡ä»¶é‡Œä¼šæŒ‡å‘è¿™å‡ ä¸ªæ–‡ä»¶ã€‚</p><img src=https://cdn.jsdelivr.net/gh/aaronmack/image-hosting@master/e/image.3dc6baa8low0.webp alt=image width=500/>
<a href=#ç”³è¯·å…è´¹-ssl><h1 id=ç”³è¯·å…è´¹-ssl><span class=hanchor arialabel=Anchor># </span>ç”³è¯·å…è´¹ SSL</h1></a><a href=#install-1><h2 id=install-1><span class=hanchor arialabel=Anchor># </span>Install</h2></a><p>ä½¿ç”¨Let&rsquo;s Encryptå…è´¹çš„SSLè¯ä¹¦ã€‚</p><p>Linuxä¸‹å®‰è£…ä½¿ç”¨certbotå‘½ä»¤è¡Œå·¥å…·ï¼Œ<code>sudo apt install certbot</code> ã€‚</p><p>æˆ‘è¿™é‡Œçš„æœåŠ¡æœºå™¨é…ç½®å·²ç»æœ‰äº†ä¸€ä¸ªcaddyï¼Œæ‰€ä»¥nginxæ²¡æœ‰å»å ç”¨80ä¸ª443ç«¯å£ï¼Œæ‰€ä»¥cerbotæˆ‘ä½¿ç”¨çš„æ˜¯ç‹¬ç«‹æ¨¡å¼ã€‚</p><p>è¿˜æœ‰å…¶å®ƒçš„é€‰é¡¹æ¯”å¦‚&ndash;nginxï¼Œä¼šè‡ªåŠ¨é…ç½®å¥½nginxç›¸å…³çš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>// æœ‰å¤šä¸ªåŸŸåå’Œå­åŸŸåä½¿ç”¨-dæ·»åŠ å¤šä¸ª
</span></span><span class=line><span class=cl>certbot certonly --standalone -d xyzzyxwz.top -d server1.xyzzyxwz.top
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// å†æ ¹æ®æç¤ºä¸€æ­¥ä¸€æ­¥æ“ä½œï¼Œè¿™é‡Œç­‰DNSè§£æéœ€è¦ä¸€æ®µæ—¶é—´
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>//æˆåŠŸåé‡å¯nginxæœåŠ¡
</span></span><span class=line><span class=cl>systemctl restart nginx
</span></span></code></pre></td></tr></table></div></div><a href=#renew><h2 id=renew><span class=hanchor arialabel=Anchor># </span>Renew</h2></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crontab -e
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> 0,12 * * * python -c <span class=s1>&#39;import random; import time; time.sleep(random.random() * 3600)&#39;</span> <span class=o>&amp;&amp;</span> systemctl stop caddy <span class=o>&amp;&amp;</span> certbot renew <span class=o>&amp;&amp;</span> systemctl start caddy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>//æœ‰æ—¶å€™è¿™ä¸ªå®šæ—¶ä»»åŠ¡ä¸èµ·ä½œç”¨ï¼Œéœ€è¦åœ¨åˆ°æœŸå‰æ‰‹åŠ¨æ‰§è¡Œä¸€ä¸‹ä¸Šè¿°å‘½ä»¤
</span></span></code></pre></td></tr></table></div></div><a href=#config-1><h2 id=config-1><span class=hanchor arialabel=Anchor># </span>Config</h2></a><p>å› ä¸ºåœ¨ç”³è¯·SSLæ—¶æˆ‘ä»¬ç”¨çš„standaloneæ¨¡å¼ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ‰‹åŠ¨é…ç½®SSLã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// ç¬¬ä¸€ä¸ªæœåŠ¡ ï¼ˆç”¨äºfrpåå‘ä»£ç†ï¼‰
</span></span><span class=line><span class=cl>//   æš´éœ²12030ç«¯å£ç»™å¤–éƒ¨è®¿é—®
</span></span><span class=line><span class=cl>//   ä»£ç†å†…éƒ¨çš„ç«¯å£13040ï¼Œè¿™ä¸ªç«¯å£æ˜¯è®¾ç½®åœ¨frpæœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ä¸­çš„vhost-http
</span></span><span class=line><span class=cl>// -----
</span></span><span class=line><span class=cl>// `listen 12034 ssl http2;` åŒæ—¶æš´éœ²äº†12034ç«¯å£
</span></span><span class=line><span class=cl>//     å¯ä»¥ç»™å†…éƒ¨çš„ub-apiæœåŠ¡åšè½¬å‘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server {
</span></span><span class=line><span class=cl>    listen       12030 default_server;
</span></span><span class=line><span class=cl>    listen       [::]:12030 default_server;
</span></span><span class=line><span class=cl>    server_name  xyzzyxwz.top;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    underscores_in_headers on;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    listen 12034 ssl http2;
</span></span><span class=line><span class=cl>    ssl on;
</span></span><span class=line><span class=cl>    ssl_certificate /etc/letsencrypt/live/xyzzyxwz.top/fullchain.pem;
</span></span><span class=line><span class=cl>    ssl_certificate_key /etc/letsencrypt/live/xyzzyxwz.top/privkey.pem;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ssl_protocols TLSv1.2 TLSv1.3;
</span></span><span class=line><span class=cl>    ssl_ciphers &#34;ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384&#34;;     
</span></span><span class=line><span class=cl>    #ssl_prefer_server_ciphers on;
</span></span><span class=line><span class=cl>    ssl_session_cache shared:le_nginx_SSL:10m;
</span></span><span class=line><span class=cl>    ssl_session_timeout 1440m;
</span></span><span class=line><span class=cl>    ssl_session_tickets off;
</span></span><span class=line><span class=cl>    ssl_prefer_server_ciphers off;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    error_page 497  https://$host$request_uri;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    #limit_conn perserver 300;
</span></span><span class=line><span class=cl>    #limit_conn perip 25;
</span></span><span class=line><span class=cl>    #limit_rate 512k;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    # Load configuration files for the default server block.
</span></span><span class=line><span class=cl>    include /etc/nginx/default.d/*.conf;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / {
</span></span><span class=line><span class=cl>        proxy_redirect off;
</span></span><span class=line><span class=cl>        #proxy_set_header Host $host;
</span></span><span class=line><span class=cl>        proxy_set_header Host $http_host;
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP $remote_addr;
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Protocol $scheme;
</span></span><span class=line><span class=cl>        proxy_set_header X-Url-Scheme $scheme;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        proxy_http_version 1.1;
</span></span><span class=line><span class=cl>        proxy_set_header Upgrade $http_upgrade;
</span></span><span class=line><span class=cl>        proxy_set_header Connection &#34;upgrade&#34;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        proxy_pass http://127.0.0.1:13040;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            add_header Access-Control-Allow-Origin *;
</span></span><span class=line><span class=cl>            add_header Access-Control-Allow-Methods &#39;GET, POST, OPTIONS&#39;;
</span></span><span class=line><span class=cl>            add_header Access-Control-Allow-Headers &#39;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization&#39;;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    # If the page is static and does not contain a redirection, this method is OK, or how to change the redirection url with this prefix?
</span></span><span class=line><span class=cl>    location ^~ /n1/ {
</span></span><span class=line><span class=cl>        proxy_pass http://localhost:8001/;
</span></span><span class=line><span class=cl>        proxy_http_version 1.1;
</span></span><span class=line><span class=cl>        proxy_set_header Upgrade $http_upgrade;
</span></span><span class=line><span class=cl>        proxy_set_header Connection keep-alive;
</span></span><span class=line><span class=cl>        proxy_set_header Host $host;
</span></span><span class=line><span class=cl>        proxy_cache_bypass $http_upgrade;
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    # â€¦
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    error_page 404 /404.html;
</span></span><span class=line><span class=cl>        location = /40x.html {
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    error_page 500 502 503 504 /50x.html;
</span></span><span class=line><span class=cl>        location = /50x.html {
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// ç¬¬äºŒä¸ªæœåŠ¡ï¼ˆè‡ªå·±serveä¸€äº›çš„æœåŠ¡ï¼Œä¹Ÿå¯ä»¥èµ°sslï¼‰ï¼Œ
</span></span><span class=line><span class=cl>//   åƒä¸‹é¢å°±æ˜¯æš´éœ²9001ç»™å¤–éƒ¨ï¼Œç›‘å¬è½¬å‘å†…éƒ¨8001ç«¯å£
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server{
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    listen       9001 default_server;
</span></span><span class=line><span class=cl>    listen       [::]:9001 default_server;
</span></span><span class=line><span class=cl>    server_name  xyzzyxw.top;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ssl on;
</span></span><span class=line><span class=cl>    ssl_certificate /etc/letsencrypt/live/xyzzyxw.top/fullchain.pem;
</span></span><span class=line><span class=cl>    ssl_certificate_key /etc/letsencrypt/live/xyzzyxw.top/privkey.pem;
</span></span><span class=line><span class=cl>    ssl_protocols TLSv1.2 TLSv1.3;
</span></span><span class=line><span class=cl>    ssl_ciphers &#34;ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384&#34;;
</span></span><span class=line><span class=cl>    ssl_session_timeout 1440m;
</span></span><span class=line><span class=cl>    ssl_session_tickets off;
</span></span><span class=line><span class=cl>    ssl_prefer_server_ciphers off;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / {
</span></span><span class=line><span class=cl>            proxy_pass http://localhost:8001/;
</span></span><span class=line><span class=cl>            proxy_http_version 1.1;
</span></span><span class=line><span class=cl>            proxy_set_header Upgrade $http_upgrade;
</span></span><span class=line><span class=cl>            proxy_set_header Connection keep-alive;
</span></span><span class=line><span class=cl>            proxy_set_header Host $host;
</span></span><span class=line><span class=cl>            proxy_cache_bypass $http_upgrade;
</span></span><span class=line><span class=cl>            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>            proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><a href=#å¸¸ç”¨å‘½ä»¤><h1 id=å¸¸ç”¨å‘½ä»¤><span class=hanchor arialabel=Anchor># </span>å¸¸ç”¨å‘½ä»¤</h1></a><p>æœ‰æ—¶å€™æˆ‘ä»¬SSHè¿œç¨‹è¿æ¥åˆ°ä¸»æœºåï¼Œæƒ³æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸”åœ¨ç»ˆç«¯æ„å¤–é€€å‡ºåä»ç„¶ç»§ç»­è¿è¡Œã€‚è¿™å°±éœ€è¦åˆ°screenå•¦ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># screen run</span>
</span></span><span class=line><span class=cl>yum install screen
</span></span><span class=line><span class=cl>screen -S ssl  <span class=c1># start new</span>
</span></span><span class=line><span class=cl>screen -r <span class=o>[</span>id<span class=o>]</span> <span class=c1># attach one</span>
</span></span><span class=line><span class=cl>  <span class=c1># Ctrl+A D  - will detach</span>
</span></span><span class=line><span class=cl>  <span class=c1># Ctrl+D    - will terminate</span>
</span></span></code></pre></td></tr></table></div></div><p>mysqlç›¸å…³ã€‚ğŸ˜‚ğŸ¤£ğŸ˜„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># mysql</span>
</span></span><span class=line><span class=cl>mysql -u root -p
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Re-Increment id
</span></span><span class=line><span class=cl>// table_bakæ˜¯å¤‡ä»½å‡ºçš„è¡¨
</span></span><span class=line><span class=cl>create table table_bak like &lt;table_name&gt;<span class=p>;</span>
</span></span><span class=line><span class=cl>insert into table_bak <span class=k>select</span> * from &lt;table_name&gt;<span class=p>;</span>
</span></span><span class=line><span class=cl>alter table table_bak drop id<span class=p>;</span>
</span></span><span class=line><span class=cl>alter table table_bak add id int<span class=o>(</span>11<span class=o>)</span> primary key auto_increment first<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Change Password
</span></span><span class=line><span class=cl>ALTER USER <span class=s1>&#39;root&#39;</span>@<span class=s1>&#39;%&#39;</span> IDENTIFIED BY <span class=s1>&#39;&lt;yourpasswd&gt;&#39;</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>flush privileges<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Query users
</span></span><span class=line><span class=cl>SELECT User, Host, Grant_priv, Super_priv
</span></span><span class=line><span class=cl>FROM mysql.user<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Create user with super grant
</span></span><span class=line><span class=cl>CREATE USER <span class=s1>&#39;username&#39;</span>@<span class=s1>&#39;%&#39;</span> IDENTIFIED BY <span class=s1>&#39;password&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>GRANT ALL ON *.* TO <span class=s1>&#39;username&#39;</span>@<span class=s1>&#39;%&#39;</span> WITH GRANT OPTION<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>#GRANT ALL PRIVILEGES ON *.* TO &#39;aaron&#39;@&#39;%&#39; WITH GRANT OPTION; </span>
</span></span><span class=line><span class=cl>FLUSH PRIVILEGES<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Remove user
</span></span><span class=line><span class=cl>DROP USER <span class=s1>&#39;username&#39;</span>@<span class=s1>&#39;%&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>FLUSH PRIVILEGES<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- Create database
</span></span><span class=line><span class=cl>CREATE DATABASE testdb<span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#ubuntu22-04-å®‰è£…mongodb><h1 id=ubuntu22-04-å®‰è£…mongodb><span class=hanchor arialabel=Anchor># </span>Ubuntu22-04 å®‰è£…Mongodb</h1></a><p><a href=https://www.cherryservers.com/blog/install-mongodb-ubuntu-22-04 rel=noopener>How to Install MongoDB on Ubuntu 22.04 | Cherry Servers</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…å®‰è£…è¿‡ç¨‹ä¸­æ‰€éœ€çš„å…ˆå†³æ¡ä»¶åŒ…ã€‚</span>
</span></span><span class=line><span class=cl>sudo apt install software-properties-common gnupg apt-transport-https ca-certificates -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¦å®‰è£…æœ€æ–°çš„ MongoDB è½¯ä»¶åŒ…ï¼Œéœ€è¦å°† MongoDB è½¯ä»¶åŒ…ä»“åº“æ·»åŠ åˆ° Ubuntu çš„æºä»£ç åˆ—è¡¨æ–‡ä»¶ä¸­ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦ä½¿ç”¨ wget å‘½ä»¤åœ¨ç³»ç»Ÿä¸­å¯¼å…¥ MongoDB çš„å…¬é’¥</span>
</span></span><span class=line><span class=cl>curl -fsSL https://pgp.mongodb.com/server-7.0.asc <span class=p>|</span>  sudo gpg -o /usr/share/keyrings/mongodb-server-7.0.gpg --dearmor
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åœ¨ /etc/apt/sources.list.d ç›®å½•ä¸­æ·»åŠ  MongoDB 7.0 APT ä»£ç åº“</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-7.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥å®ƒ cat /etc/apt/sources.list.d/mongodb-org-7.0.list</span>
</span></span><span class=line><span class=cl>sudo apt update	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®‰è£…Mongodb</span>
</span></span><span class=line><span class=cl>sudo apt install mongodb-org -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯ç”¨MongoDBåœ¨å¯åŠ¨æ—¶å¯åŠ¨</span>
</span></span><span class=line><span class=cl>mongod --version
</span></span><span class=line><span class=cl>sudo systemctl status mongod
</span></span><span class=line><span class=cl>sudo systemctl start mongod
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> mongod
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬</span>
</span></span><span class=line><span class=cl>sudo ss -pnltu <span class=p>|</span> grep <span class=m>27017</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºè´¦å· (è¿™ä¸ªæ—¶å€™è¿˜ä¸éœ€è¦å¯†ç è®¿é—®)</span>
</span></span><span class=line><span class=cl>mongosh
</span></span><span class=line><span class=cl>show dbs
</span></span><span class=line><span class=cl>use admin
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>db.createUser<span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=o>{</span>
</span></span><span class=line><span class=cl>    user: <span class=s2>&#34;root&#34;</span>,
</span></span><span class=line><span class=cl>    pwd: passwordPrompt<span class=o>()</span>,
</span></span><span class=line><span class=cl>    roles: <span class=o>[</span> <span class=o>{</span> role: <span class=s2>&#34;userAdminAnyDatabase&#34;</span>, db: <span class=s2>&#34;admin&#34;</span> <span class=o>}</span>, <span class=s2>&#34;readWriteAnyDatabase&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>)</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®å¤–éƒ¨è®¿é—® ï¼ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¯†ç è®¿é—®äº†ï¼‰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo nano /etc/mongod.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Change <span class=sb>`</span>bindIp: 127.0.0.1<span class=sb>`</span> to <span class=sb>`</span>bindIp: 0.0.0.0<span class=sb>`</span>
</span></span><span class=line><span class=cl>Change <span class=sb>`</span>port: 27017<span class=sb>`</span> to <span class=sb>`</span>port: 27070<span class=sb>`</span>
</span></span><span class=line><span class=cl>Add security:
</span></span><span class=line><span class=cl>    authorization: enabled
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo systemctl restart mongod
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mongosh -u &lt;username&gt; -p &lt;password&gt;
</span></span></code></pre></td></tr></table></div></div><a href=#ubuntu22-04-å®‰è£…postgresql><h1 id=ubuntu22-04-å®‰è£…postgresql><span class=hanchor arialabel=Anchor># </span>Ubuntu22-04 å®‰è£…postgresql</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># INSTALL postgresql</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt install postgresql
</span></span><span class=line><span class=cl>systemctl status postgresql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/postgresql/&lt;version&gt;/main/postgresql.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>: <span class=nv>listen_addresses</span> <span class=o>=</span> <span class=s1>&#39;*&#39;</span>
</span></span><span class=line><span class=cl>: <span class=nv>port</span> <span class=o>=</span> &lt;new_port&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo -u postgres psql template1
</span></span><span class=line><span class=cl>ALTER USER postgres with encrypted password <span class=s1>&#39;&lt;password&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/postgresql/&lt;version&gt;/main/pg_hba.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>: host  all  all 0.0.0.0/0 scram-sha-256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>su - postgres
</span></span><span class=line><span class=cl>psql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=se>\l</span>   <span class=c1># list database</span>
</span></span><span class=line><span class=cl><span class=se>\d</span>u  <span class=c1># list users</span>
</span></span><span class=line><span class=cl>drop user IF EXISTS &lt;uasername&gt;<span class=p>;</span>
</span></span><span class=line><span class=cl>create database ayon<span class=p>;</span>
</span></span><span class=line><span class=cl>create user &lt;username&gt; WITH PASSWORD <span class=s1>&#39;&lt;password&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>grant ALL PRIVILEGES ON DATABASE &lt;database&gt; TO &lt;username&gt;<span class=p>;</span>
</span></span><span class=line><span class=cl>alter USER &lt;username&gt; WITH SUPERUSER<span class=p>;</span>
</span></span><span class=line><span class=cl>alter USER &lt;username&gt; WITH NOSUPERUSER<span class=p>;</span>
</span></span><span class=line><span class=cl>alter USER &lt;username&gt; CREATEDB<span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#ubuntu22-04-å®‰è£…redis><h1 id=ubuntu22-04-å®‰è£…redis><span class=hanchor arialabel=Anchor># </span>Ubuntu22-04 å®‰è£…redis</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># INSTALL redis</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt install lsb-release curl gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -fsSL https://packages.redis.io/gpg <span class=p>|</span> sudo gpg --dearmor -o /usr/share/keyrings/redis-archive-keyring.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span class=k>$(</span>lsb_release -cs<span class=k>)</span><span class=s2> main&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/redis.list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install redis
</span></span><span class=line><span class=cl>systemctl status redis-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/redis/redis.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>: supervised systemd
</span></span><span class=line><span class=cl>: <span class=c1>#bind 127.0.0.1 -::1</span>
</span></span><span class=line><span class=cl>: port &lt;new-port&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># test</span>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>redis-cli
</span></span><span class=line><span class=cl>ping
</span></span><span class=line><span class=cl><span class=nb>set</span> <span class=nb>test</span> <span class=s2>&#34;It&#39;s working!&#34;</span>
</span></span><span class=line><span class=cl>get <span class=nb>test</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>systemctl restart redis-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate a password (with `openssl rand 60 | openssl base64 -A`)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/redis/redis.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>: requirepass &lt;password&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>systemctl restart redis-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># test</span>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>redis-cli
</span></span><span class=line><span class=cl><span class=nb>set</span> key1 <span class=m>10</span>
</span></span><span class=line><span class=cl>auth &lt;password&gt;
</span></span><span class=line><span class=cl><span class=nb>set</span> key1 <span class=m>10</span>
</span></span><span class=line><span class=cl>get key1
</span></span><span class=line><span class=cl>quit
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># more secure info: https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-20-04</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ACL</span>
</span></span><span class=line><span class=cl>touch /root/users.acl
</span></span><span class=line><span class=cl>nano /etc/redis/redis.conf
</span></span><span class=line><span class=cl>: aclfile /root/users.acl
</span></span><span class=line><span class=cl>: protected-mode no
</span></span><span class=line><span class=cl>systemctl restart redis-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-----
</span></span><span class=line><span class=cl>redis-cli
</span></span><span class=line><span class=cl>auth &lt;password&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>acl users
</span></span><span class=line><span class=cl>acl whoami
</span></span><span class=line><span class=cl>acl setuser &lt;username&gt;     <span class=c1># åˆ›å»º</span>
</span></span><span class=line><span class=cl>acl setuser &lt;username&gt; on  <span class=c1># å¯ç”¨</span>
</span></span><span class=line><span class=cl>acl list
</span></span><span class=line><span class=cl>acl seruser &lt;username&gt; &gt;&lt;password&gt; <span class=c1># è®¾ç½®å¯†ç </span>
</span></span><span class=line><span class=cl>acl setuser &lt;username&gt; <span class=s>&lt;&lt;password&gt; # å–æ¶ˆå¯†ç 
</span></span></span><span class=line><span class=cl><span class=s>acl deluser &lt;username&gt;
</span></span></span><span class=line><span class=cl><span class=s>acl cat   # æŸ¥çœ‹é›†åˆ
</span></span></span><span class=line><span class=cl><span class=s>acl setuser &lt;username&gt; on &gt;&lt;password</span>&gt; allkeys allcommands
</span></span><span class=line><span class=cl>acl setuser &lt;username&gt; on &gt;&lt;password&gt; ~* <span class=p>&amp;</span>* +@all
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>acl save  <span class=c1># æŒä¹…åŒ–</span>
</span></span><span class=line><span class=cl>-----
</span></span></code></pre></td></tr></table></div></div><a href=#sshç¦ç”¨å¯†ç ç™»å½•><h1 id=sshç¦ç”¨å¯†ç ç™»å½•><span class=hanchor arialabel=Anchor># </span>SSHç¦ç”¨å¯†ç ç™»å½•</h1></a><p>å‘ç°Mongodbæ•°æ®åº“è¢«å‹’ç´¢äº†ï¼Œè™½ç„¶é‡Œé¢æ²¡æœ‰ç‰¹åˆ«é‡è¦çš„æ•°æ®ï¼Œä½†é‚£äº›å…³äºPipelineé…ç½®å°±éƒ½æ²¡æœ‰äº†~ å¦‚æœè¿™æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œåæœä¸å ªè®¾æƒ³ï¼Œè¦å®šæœŸå¤‡ä»½ï¼ŒåŠ å¼ºå®‰å…¨æ€§~</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano /etc/ssh/sshd_config
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å°†ä¸‹é¢è¿™å¥è¯ç§»åˆ°sshd_configæ–‡ä»¶çš„å¼€å¤´ï¼ˆå¦‚æœä¸èµ·ä½œç”¨çš„è¯ï¼‰</span>
</span></span><span class=line><span class=cl>PasswordAuthentication no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å†å¼€å¯è¿™ä¸¤å¥è¯</span>
</span></span><span class=line><span class=cl>PubkeyAuthentication yes
</span></span><span class=line><span class=cl>AuthorizedKeysFile      .ssh/authorized_keys .ssh/authorized_keys2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#é‡å¯SSHæœåŠ¡</span>
</span></span><span class=line><span class=cl>systemctl restart sshd.service
</span></span></code></pre></td></tr></table></div></div><a href=#linuxé…ç½®navieä»£ç†><h1 id=linuxé…ç½®navieä»£ç†><span class=hanchor arialabel=Anchor># </span>Linuxé…ç½®navieä»£ç†</h1></a><a href=#æœåŠ¡ç«¯><h2 id=æœåŠ¡ç«¯><span class=hanchor arialabel=Anchor># </span>æœåŠ¡ç«¯</h2></a><a href=#å®¢æˆ·ç«¯><h2 id=å®¢æˆ·ç«¯><span class=hanchor arialabel=Anchor># </span>å®¢æˆ·ç«¯</h2></a><p>nekoray</p><a href=#redsocks-å®ç°å…¨å±€ä»£ç†><h1 id=redsocks-å®ç°å…¨å±€ä»£ç†><span class=hanchor arialabel=Anchor># </span>redsocks å®ç°å…¨å±€ä»£ç†</h1></a><p>reference:
<a href=https://github.com/tazihad/ProxifierLinux rel=noopener>https://github.com/tazihad/ProxifierLinux</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1. å®‰è£…
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt-get update  
</span></span><span class=line><span class=cl>sudo apt-get install redsocks
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. ä¿®æ”¹é…ç½®æ–‡ä»¶
</span></span><span class=line><span class=cl>sudo nano /etc/redsocks.conf
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>redsocks <span class=o>{</span>  
</span></span><span class=line><span class=cl>	<span class=nv>local_ip</span> <span class=o>=</span> 127.0.0.1<span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=nv>local_port</span> <span class=o>=</span> 11111<span class=p>;</span>  
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=nv>ip</span> <span class=o>=</span> 192.168.31.200<span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=nv>port</span> <span class=o>=</span> 10808<span class=p>;</span>   
</span></span><span class=line><span class=cl>	<span class=nb>type</span> <span class=o>=</span> socks5<span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. å¼€å¯
</span></span><span class=line><span class=cl>systemctl start redsocks
</span></span><span class=line><span class=cl>iptables -t nat -F
</span></span><span class=line><span class=cl>iptables -t nat -N REDSOCKS
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 0.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 10.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 127.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 169.254.0.0/16 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 172.16.0.0/12 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 192.168.0.0/16 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 224.0.0.0/4 -j RETURN 
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -d 240.0.0.0/4 -j RETURN
</span></span><span class=line><span class=cl>iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports <span class=m>11111</span>
</span></span><span class=line><span class=cl>iptables -t nat -A OUTPUT -p tcp -j REDSOCKS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. å…³é—­
</span></span><span class=line><span class=cl>systemctl stop redsocks
</span></span><span class=line><span class=cl>iptables -t nat -F OUTPUT 
</span></span><span class=line><span class=cl>iptables -t nat -F REDSOCKS 
</span></span><span class=line><span class=cl>iptables -t nat -X REDSOCKS
</span></span></code></pre></td></tr></table></div></div><a href=#rawgithubusercontentcom-æ— æ³•è®¿é—®><h1 id=rawgithubusercontentcom-æ— æ³•è®¿é—®><span class=hanchor arialabel=Anchor># </span>raw.githubusercontent.com æ— æ³•è®¿é—®</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo nano /etc/hosts
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>185.199.108.133 raw.githubusercontent.com
</span></span><span class=line><span class=cl>---
</span></span></code></pre></td></tr></table></div></div><a href=#æ ‘è“æ´¾-4b-æ‘„åƒå¤´><h1 id=æ ‘è“æ´¾-4b-æ‘„åƒå¤´><span class=hanchor arialabel=Anchor># </span>æ ‘è“æ´¾ 4b æ‘„åƒå¤´</h1></a><p><a href=https://github.com/motioneye-project/motioneye rel=noopener>https://github.com/motioneye-project/motioneye</a></p><blockquote class=info-callout><p>ä¸çŸ¥ä¸ºä½•ä½¿ç”¨CSIæ‘„åƒå¤´æ—¶ï¼Œæ ‘è“æ´¾ç”µæºLEDç¯é—ªçƒï¼Œä¾›ç”µä¸è¶³ï¼Œä½†æ˜¯ç”µæºæ˜¯ç”¨DC POWER SUPPLYå»ä¾›ç”µçš„ï¼Œç„¶åæ”¹ç”¨USBæ‘„åƒå¤´æ‰å¥½çš„ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># virtualenv for python3</span>
</span></span><span class=line><span class=cl><span class=c1># activate it!</span>
</span></span><span class=line><span class=cl><span class=c1># Install motioneye</span>
</span></span><span class=line><span class=cl>sudo python3 -m pip install --pre motioneye
</span></span><span class=line><span class=cl>sudo motioneye_init
</span></span></code></pre></td></tr></table></div></div><a href=#æ ‘è“æ´¾ç³»ç»Ÿå†™å…¥><h1 id=æ ‘è“æ´¾ç³»ç»Ÿå†™å…¥><span class=hanchor arialabel=Anchor># </span>æ ‘è“æ´¾ç³»ç»Ÿå†™å…¥</h1></a><p>SD Card Formatter
Win32 Disk Imager</p><ol><li>Ubuntu Mate<ol><li><a href=https://ubuntu-mate.org/download/arm64/jammy/ rel=noopener>https://ubuntu-mate.org/download/arm64/jammy/</a></li></ol></li><li>ImmortalWrt<ol><li>PI 3b+
<a href=https://downloads.immortalwrt.org/releases/23.05.2/targets/bcm27xx/bcm2710/ rel=noopener>https://downloads.immortalwrt.org/releases/23.05.2/targets/bcm27xx/bcm2710/</a></li></ol></li></ol><a href=#ubuntu-è®¾ç½®å¯åŠ¨æ—¶é»˜è®¤è¿›å…¥å‘½ä»¤è¡Œå›¾å½¢ç•Œé¢><h1 id=ubuntu-è®¾ç½®å¯åŠ¨æ—¶é»˜è®¤è¿›å…¥å‘½ä»¤è¡Œå›¾å½¢ç•Œé¢><span class=hanchor arialabel=Anchor># </span>Ubuntu è®¾ç½®å¯åŠ¨æ—¶é»˜è®¤è¿›å…¥å‘½ä»¤è¡Œ&å›¾å½¢ç•Œé¢</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#sudo systemctl enable multi-user.target --force </span>
</span></span><span class=line><span class=cl><span class=c1># Command Line</span>
</span></span><span class=line><span class=cl>sudo systemctl set-default multi-user.target
</span></span><span class=line><span class=cl><span class=c1># Graphical</span>
</span></span><span class=line><span class=cl>sudo systemctl set-default graphical.target
</span></span><span class=line><span class=cl><span class=c1># start desktop </span>
</span></span><span class=line><span class=cl>startx
</span></span></code></pre></td></tr></table></div></div><a href=#ubuntu-è®¾ç½®è¯»å–ntfsç¡¬ç›˜><h1 id=ubuntu-è®¾ç½®è¯»å–ntfsç¡¬ç›˜><span class=hanchor arialabel=Anchor># </span>Ubuntu è®¾ç½®è¯»å–ntfsç¡¬ç›˜</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt install ntfs*
</span></span><span class=line><span class=cl>sudo fdisk -l
</span></span><span class=line><span class=cl>lsblk
</span></span><span class=line><span class=cl>sudo mount -t ntfs-3g /dev/sda1 /mnt/od
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># æ£€æŸ¥æŒ‚è½½
</span></span><span class=line><span class=cl>mount | grep /dev/sda1
</span></span><span class=line><span class=cl># å–æ¶ˆæŒ‚è½½
</span></span><span class=line><span class=cl>sudo umount /dev/sda1
</span></span><span class=line><span class=cl># å¼¹å‡ºè®¾å¤‡
</span></span><span class=line><span class=cl>sudo eject /dev/sda1
</span></span></code></pre></td></tr></table></div></div><a href=#å¾®è½¯auto-renewal><h1 id=å¾®è½¯auto-renewal><span class=hanchor arialabel=Anchor># </span>å¾®è½¯Auto Renewal</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=err>#</span> <span class=nx>åˆ›å»ºä¸€ä¸ªserviceç”¨äºauth</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=o>=</span><span class=nx>Microsoft</span> <span class=nx>E5</span> <span class=nx>Auto</span> <span class=nx>Renewal</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=o>=</span><span class=nx>network</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=o>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>WorkingDirectory</span><span class=o>=</span><span class=err>/root/Microsoft-API-Test</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=o>=</span><span class=nx>python3</span><span class=mf>.10</span> <span class=o>/</span><span class=nx>root</span><span class=o>/</span><span class=nx>Microsoft</span><span class=o>-</span><span class=nx>API</span><span class=o>-</span><span class=nx>Test</span><span class=o>/</span><span class=nx>auth</span><span class=p>.</span><span class=nx>py</span> <span class=p>&lt;</span><span class=nt>client_id</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>secret</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=o>=</span><span class=nx>on</span><span class=o>-</span><span class=nx>failure</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=o>=</span><span class=nx>multi</span><span class=o>-</span><span class=nx>user</span><span class=p>.</span><span class=nx>target</span>
</span></span></code></pre></td></tr></table></div></div><p>code</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=err>#</span> <span class=nx>åˆ›å»ºä¸€ä¸ªæœåŠ¡ç”¨äºè¿è¡Œä¸»ç¨‹åº</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=o>=</span><span class=nx>Microsoft</span> <span class=nx>E5</span> <span class=nx>Auto</span> <span class=nx>Renewal</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=o>=</span><span class=nx>network</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=o>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>WorkingDirectory</span><span class=o>=</span><span class=err>/root/Microsoft-API-Test</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=o>=</span><span class=nx>python3</span><span class=mf>.10</span> <span class=o>/</span><span class=nx>root</span><span class=o>/</span><span class=nx>Microsoft</span><span class=o>-</span><span class=nx>API</span><span class=o>-</span><span class=nx>Test</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=nx>py</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=o>=</span><span class=nx>on</span><span class=o>-</span><span class=nx>failure</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=o>=</span><span class=nx>multi</span><span class=o>-</span><span class=nx>user</span><span class=p>.</span><span class=nx>target</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=err>#</span> <span class=nx>ç”¨äºè·å–refresh</span> <span class=nx>token</span>
</span></span><span class=line><span class=cl><span class=nx>python</span> <span class=nx>auth</span><span class=p>.</span><span class=nx>py</span> <span class=nx>YourClientID</span> <span class=nx>YourClientSecret</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>è¿è¡Œ</span>
</span></span><span class=line><span class=cl><span class=nx>python</span> <span class=nx>main</span><span class=p>.</span><span class=nx>py</span>
</span></span></code></pre></td></tr></table></div></div><a href=#rclone-é…ç½®-onedrive-5t><h1 id=rclone-é…ç½®-onedrive-5t><span class=hanchor arialabel=Anchor># </span>rclone é…ç½® onedrive 5T</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># rclone å®‰è£…</span>
</span></span><span class=line><span class=cl>sudo -v <span class=p>;</span> curl https://rclone.org/install.sh <span class=p>|</span> sudo bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åœ¨Microsoft Azure App Registrationsä¸­åˆ›å»ºæ–°çš„application</span>
</span></span><span class=line><span class=cl>1. redirect url: http://localhost:53682
</span></span><span class=line><span class=cl>2.æƒé™ï¼š
</span></span><span class=line><span class=cl>		Files.Read
</span></span><span class=line><span class=cl>		Files.Read.All
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		Files.ReadWrite
</span></span><span class=line><span class=cl>		Files.ReadWrite.All
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		offline_access
</span></span><span class=line><span class=cl>		User.Read
</span></span><span class=line><span class=cl>3.åˆ›å»ºsecretså¹¶è®°å½•
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®rclone</span>
</span></span><span class=line><span class=cl>&gt; rclone config
</span></span><span class=line><span class=cl>é…ç½®ä¸­é€‰æ‹©Microsoft OneDriveã€‚ä¾‹å¦‚åç§°å«onedriveã€‚å¡«å…¥Client IDä¸Secret IDã€‚æœ€åå½“å‡ºç°éœ€è¦è¾“å…¥config_token&gt; æ—¶
</span></span><span class=line><span class=cl>æ‰§è¡Œå‘½ä»¤rclone authorize <span class=s2>&#34;onedrive&#34;</span>è¿›è¡Œé…ç½®ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æŒ‚è½½åŒæ­¥</span>
</span></span><span class=line><span class=cl>rclone sync odrive:sync/aync /mnt/od/aync
</span></span></code></pre></td></tr></table></div></div><a href=#æ ‘è“æ´¾å‘½ä»¤è¡Œè¿æ¥wifi><h1 id=æ ‘è“æ´¾å‘½ä»¤è¡Œè¿æ¥wifi><span class=hanchor arialabel=Anchor># </span>æ ‘è“æ´¾å‘½ä»¤è¡Œè¿æ¥wifi</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=err>#</span> <span class=mf>1.</span><span class=nx>æ£€æŸ¥ä¿¡é“ä¸é…ç½®åœ°åŒºä¸ºUS</span>
</span></span><span class=line><span class=cl><span class=nx>iwlist</span> <span class=nx>channel</span>
</span></span><span class=line><span class=cl><span class=nx>raspi</span><span class=o>-</span><span class=nx>config</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>æ˜¾ç¤ºå½“å‰è¿æ¥çš„wifi</span>
</span></span><span class=line><span class=cl><span class=nx>nmcli</span> <span class=nx>con</span> <span class=nx>show</span> <span class=o>--</span><span class=nx>active</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>æ‰«æå½“å‰wifi</span>
</span></span><span class=line><span class=cl><span class=nx>nmcli</span> <span class=nx>dev</span> <span class=nx>wifi</span> <span class=nx>list</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>è¿æ¥åˆ°ä¸€ä¸ªæ–°çš„wifi</span>
</span></span><span class=line><span class=cl><span class=nx>nmcli</span> <span class=nx>dev</span> <span class=nx>wifi</span> <span class=nx>connect</span> <span class=p>&lt;</span><span class=nt>SSID</span><span class=p>&gt;</span> <span class=nx>password</span> <span class=p>&lt;</span><span class=nt>password</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#mysqlå¯åŠ¨å¤±è´¥><h1 id=mysqlå¯åŠ¨å¤±è´¥><span class=hanchor arialabel=Anchor># </span>mysqlå¯åŠ¨å¤±è´¥</h1></a><a href=#ä¸€-æ£€æŸ¥æ˜¯å¦æ—¥å¿—æ–‡ä»¶å¤¹è¢«åˆ é™¤><h2 id=ä¸€-æ£€æŸ¥æ˜¯å¦æ—¥å¿—æ–‡ä»¶å¤¹è¢«åˆ é™¤><span class=hanchor arialabel=Anchor># </span>ä¸€ æ£€æŸ¥æ˜¯å¦æ—¥å¿—æ–‡ä»¶å¤¹è¢«åˆ é™¤</h2></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir /var/log/mysql
</span></span><span class=line><span class=cl>sudo chown -R mysql:mysql /var/log/mysql
</span></span><span class=line><span class=cl>sudo systemctl stop mysql
</span></span><span class=line><span class=cl>sudo systemctl start mysql
</span></span></code></pre></td></tr></table></div></div><a href=#linux-è®¾ç½®é€€å‡ºå-sshè¿˜èµ·ä½œç”¨><h1 id=linux-è®¾ç½®é€€å‡ºå-sshè¿˜èµ·ä½œç”¨><span class=hanchor arialabel=Anchor># </span>Linux è®¾ç½®é€€å‡ºå sshè¿˜èµ·ä½œç”¨</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install screen
</span></span><span class=line><span class=cl>screen -S &lt;name&gt;
</span></span><span class=line><span class=cl>screen -ls
</span></span></code></pre></td></tr></table></div></div><a href=#linux-è¿œç¨‹vnc-server><h1 id=linux-è¿œç¨‹vnc-server><span class=hanchor arialabel=Anchor># </span>Linux è¿œç¨‹VNC Server</h1></a><ol><li><a href=https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-vnc-on-ubuntu-20-04 rel=noopener>https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-vnc-on-ubuntu-20-04</a></li><li><a href=https://tecadmin.net/setup-x11vnc-server-on-ubuntu-linuxmint/ rel=noopener>https://tecadmin.net/setup-x11vnc-server-on-ubuntu-linuxmint/</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>sudo apt install xfce4 xfce4-goodies
</span></span><span class=line><span class=cl>sudo apt install x11vnc
</span></span><span class=line><span class=cl>x11vnc -storepasswd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo systemctl start x11vnc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨</span>
</span></span><span class=line><span class=cl>x11vnc -usepw -display :1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®</span>
</span></span><span class=line><span class=cl>mv ~/.vnc/xstartup ~/.vnc/xstartup.bak
</span></span><span class=line><span class=cl>nano ~/.vnc/xstartup
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>xrdb <span class=nv>$HOME</span>/.Xresources
</span></span><span class=line><span class=cl>startxfce4 <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>chmod +x ~/.vnc/xstartup
</span></span></code></pre></td></tr></table></div></div><a href=#å®‰è£…python-pip><h1 id=å®‰è£…python-pip><span class=hanchor arialabel=Anchor># </span>å®‰è£…python-pip</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://bootstrap.pypa.io/get-pip.py
</span></span><span class=line><span class=cl>sudo python3 get-pip.py
</span></span></code></pre></td></tr></table></div></div><a href=#mqtt-server><h1 id=mqtt-server><span class=hanchor arialabel=Anchor># </span>MQTT Server</h1></a><p>mosquitto</p><p>æ•™ç¨‹ å¦‚ä½•å®‰è£…</p><p><a href=https://medium.com/gravio-edge-iot-platform/how-to-set-up-a-mosquitto-mqtt-broker-securely-using-client-certificates-82b2aaaef9c8 rel=noopener>https://medium.com/gravio-edge-iot-platform/how-to-set-up-a-mosquitto-mqtt-broker-securely-using-client-certificates-82b2aaaef9c8</a></p><a href=#é™„å½•><h1 id=é™„å½•><span class=hanchor arialabel=Anchor># </span>é™„å½•</h1></a><ol><li>proxy.sh (global)</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>set_proxy<span class=o>(){</span>
</span></span><span class=line><span class=cl>    systemctl start redsocks
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    iptables -t nat -F
</span></span><span class=line><span class=cl>    iptables -t nat -N REDSOCKS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 0.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 10.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 127.0.0.0/8 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 169.254.0.0/16 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 172.16.0.0/12 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 192.168.0.0/16 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 224.0.0.0/4 -j RETURN 
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -d 240.0.0.0/4 -j RETURN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports <span class=m>11111</span>
</span></span><span class=line><span class=cl>    iptables -t nat -A OUTPUT -p tcp -j REDSOCKS 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Proxy has been opened.&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>unset_proxy<span class=o>(){</span>
</span></span><span class=line><span class=cl>    systemctl stop redsocks
</span></span><span class=line><span class=cl>    iptables -t nat -F OUTPUT 
</span></span><span class=line><span class=cl>    iptables -t nat -F REDSOCKS 
</span></span><span class=line><span class=cl>    iptables -t nat -X REDSOCKS 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Proxy has been closed.&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;set&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    set_proxy
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;unset&#34;</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    unset_proxy
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Unsupported arguments.&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://knowledge.xyzzyxwz.top/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Aaron Li using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2024</p><ul><li><a href=https://knowledge.xyzzyxwz.top/>Home</a></li><li><a href=https://twitter.com/aaaron_li>Twitter</a></li><li><a href=https://github.com/aaronmack>GitHub</a></li></ul></footer></div></div></body></html>